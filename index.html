<div id="login-box" style="display: none; background: #222; padding: 20px; max-width: 400px; margin: 2rem auto; border-radius: 15px; color: white; box-shadow: 0 0 15px rgba(0,255,200,0.2);">
  <h2 style="color: #00ffc3; text-align: center;">User Login</h2>
  <input type="text" id="loginUsername" placeholder="First Name" style="width: 100%; padding: 10px; margin: 10px 0; border-radius: 8px; background: #333; color: white; border: none;" />
  <input type="password" id="loginPassword" placeholder="Password" style="width: 100%; padding: 10px; margin: 10px 0; border-radius: 8px; background: #333; color: white; border: none;" />
  <button onclick="loginUser()" style="width: 100%; padding: 12px; margin-top: 10px; border-radius: 10px; background-color: #00ffc3; border: none; font-weight: bold;">Login</button>
  <div id="login-message" style="text-align: center; margin-top: 10px; color: #ff5c5c;"></div>
</div>

<div id="welcome-user" style="display: none; text-align: center; color: #00ff88; margin-top: 2rem;">
  <h2>Welcome back, <span id="userName"></span>!</h2>
</div>


<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
  import { getDatabase, ref, get, child } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-database.js";

  const firebaseConfig = {
    apiKey: "AIzaSyD-giQ4CGXX6F0RIXbAzbp_0vDDomoLo8g",
    authDomain: "qcsweeps-4b994.firebaseapp.com",
    databaseURL: "https://qcsweeps-4b994-default-rtdb.firebaseio.com",
    projectId: "qcsweeps-4b994",
    storageBucket: "qcsweeps-4b994.appspot.com",
    messagingSenderId: "810241609281",
    appId: "1:810241609281:web:63ecd22b6acbee2cf480c0"
  };

  const app = initializeApp(firebaseConfig);
  const db = getDatabase(app);

  window.loginUser = async function () {
    const firstName = document.getElementById("loginUsername").value.trim();
    const passwordInput = document.getElementById("loginPassword").value;
    const message = document.getElementById("login-message");

    try {
      const snapshot = await get(ref(db, 'users'));
      let found = false;

      snapshot.forEach((userNode) => {
        const info = userNode.val().info;
        if (info && info.FirstName.toLowerCase() === firstName.toLowerCase() && info.Password === passwordInput) {
          document.getElementById("userName").textContent = info.FirstName;
          document.getElementById("login-box").style.display = "none";
          document.getElementById("welcome-user").style.display = "block";
          found = true;
        }
      });

      if (!found) {
        message.textContent = "Invalid name or password.";
      }
    } catch (error) {
      message.textContent = "Error logging in.";
      console.error(error);
    }
  };

  // Show login by default
  document.getElementById("login-box").style.display = "block";
</script>